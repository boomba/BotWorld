<!doctype html>
<html>
    <head>
        <style src="style.css"></style>
    </head>

    <body>
        <script src="https://raw.github.com/mrdoob/three.js/master/build/three.js"></script>
        <script src="js/graphics.js"></script>
        <script src="js/Entity.js"></script>
        <script src="js/Terrain.js"></script>
        <script src="js/Player.js"></script>
        <script src="js/Resource.js"></script>
        <script>
            var debug = true;
            var timeLapse;
            var timestepStart;
            var timestepEnd;

            var engine = {
                entities: [
                    new Player(-5, 0, "Ian"),
                    new Terrain(0, 0, 5, 5),
                    new Resource(1, 0, 50),
                    new Resource(-3, 6, 10)
                ],
                resources: new Array(),
                initEntities: function() {
                    var i;
                    var len = this.entities.length;
                    for (i = 0; i < len; i++) {

                        var obj = this.entities[i];
                        if (obj.type == "Player") {
                            this.player = obj;
                            obj.birth(this.world.scene);
                        } else if (obj.type == "Terrain") {
                            this.terrain = obj;
                            obj.arise(this.world.scene);
                        } else if (obj.type == "Resource") {
                            this.resources.push(obj);
                            obj.deposit(this.world.scene);
                        }

                    }
                },
                updateEntities: function() {
                    for (var i = 0, len = this.entities.length; i < len; i++) {
                        var obj = this.entities[i];
                        obj.step();
                        obj.updateBody();
                    }
                },
                run: function() {
                    timestepEnd = Date.now();
                    animate();
                },
            };

            engine.world = initWorld();
            engine.initEntities();
            engine.player.moveTo(-3, 5);
            engine.run();
        </script>
    </body>
</html>
